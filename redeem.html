<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <!-- <title>ACCEUIL</title> -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/ico/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/ico/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/ico/favicon-16x16.png">
    <link rel="manifest" href="assets/img/ico/site.webmanifest">
    <link rel="mask-icon" href="assets/img/ico/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- <header></header> -->
    <main class="home row success" id="home">
        <div class="home-header col-md-7 col-sm-12" style="align-items: center;">
            <h3 class="home-header-title">Recuperez les documents de votre formation!  </h3>
            <p class="home-header-text">Vous avez paye et ne retrouvez point votre email contenant vos cours, entrez votre code et votre email ci dessous.</p>
            <form class="input-zone" onsubmit="event.preventDefault();" id="form" action="#">
                <input type="text" class="input" placeholder="Code" id="code" name="code" required>
                <input type="text" class="input" placeholder="Email" id="email" name="email" required> 
                <button class="button"  > <p id="text">Recuperer</p> <div class="loader" id="loader"></div></button>
            </form>
            <!-- <p>N.B. Regardez votre voite de spam si vous le mail n'apparait pas dans votre reception.</p> -->
             <!-- <p> Excepteur sint  occaecat cupidatat non proident, sunt in culpa qui officia deserunt  mollit anim id est laboru.  Excepteur sint  occaecat cupidatat non proident, sunt in culpa qui officia deserunt  mollit anim id est laboru.  Excepteur sint  occaecat cupidatat non proident, sunt in culpa qui officia deserunt  mollit anim id est laboru</p> -->
            <div> 
                
            </div>
        </div>
        <!-- <div class="home-image  col-md-5 col-sm-12"> -->
            <!-- <div class="top-right">N</div> -->
            <!-- <div class="buttom-left">M</div> -->
            <!-- <img class="bg-img" src="assets/img/hero-media.avif" alt="" srcset=""> -->
            <!-- <video src="assets/vids/ads.mp4" class="bg-img" autoplay loop controls></video> -->
            <!-- <div class="button-right"> From zero to hero</div> -->
        <!-- </div> -->
    </main>
    
    <div style="display: flex;justify-content: center;">
        <img style=" width: 50%;" src="assets/img/divider.png" alt=""> 
    </div> 
    <dialog id="modal" class="dialog">
        <h3 class="dialog-header-title">Vos documents ont etes envoyes dans votre boite email!  </h3> 
        <p></p>
        <form method="dialog" style="width: 20%;">
            <button type="submit" class="dialog-button" onclick="closeModal()">OK</button>
        </form>
    </dialog>


    <section class="FAQ" id="FAQ">
        <h3 class="question-title">
           Foire aux Questions
       </h3>
       <p class="question-text">
           Les reponses au questions frequentes a propos de cette formation.
       </p>
       <div class="question">
           <button type="button" class="question-button button">
               <p>Cette formation est-elle pour les débutants?</p>   <img src="assets/img/plus.png" class="plus" alt="">
           </button>
           <div class="answer-panel">
               <p>Oui, elle est conçue pour convenir aussi bien aux débutants qu’aux agriculteurs plus expérimentés.
               </p>
           </div>
       </div>
       <div class="question">
           <button type="button" class="question-button button">
               <p>Quelle est la durée de la formation ?</p>   <img src="assets/img/plus.png" class="plus" alt="">
           </button>
           <div class="answer-panel">
               <p>La formation est divisée en trois vidéos pour une durée totale d’environ 1 heure.</p>
           </div>
       </div>
       <div class="question">
           <button type="button" class="question-button button">
               <p>J'ai perdu mon access aux support, comment les recuperer?</p>   <img src="assets/img/plus.png" class="plus" alt="">
           </button>
           <div class="answer-panel">
               <p>Aller dans la page <a href="redeem.html">Reclamation</a> et entrez le code qui vous a ete remis a votre inscription et votre address email. Les cours vous serons envoyes si votre code est valide.</p>
           </div>
       </div>
       <div class="question">
           <button type="button" class="question-button button">
               <p>Comment continuer apres les cours?</p>   <img src="assets/img/plus.png" class="plus" alt="">
           </button>
           <div class="answer-panel">
               <p>Oui, nos packs de formation comprennent tout le nécessaire pour réussir :  modules vidéo, supports de cours, et accès à des conseils d'experts.  Parfait pour les débutants et les agriculteurs expérimentés souhaitant  se perfectionner</p>
           </div>
       </div> 
</section>
    <div style="display: flex;justify-content: center;">
        <img style=" width: 50%;" src="assets/img/divider.png" alt=""> 
    </div> 

    <footer class="footer">
        <p>Darius</p>
        <p>Designed by KTN</p>
    </footer>
    <script>
        const devApi = "http://127.0.0.1:8000";
        const prodApi = "https://api-floral-water-6550.fly.dev";
        fetch(`${prodApi}`);

        const modal = document.getElementsByTagName('dialog')[0];
        
        const closeModal = () =>{
            // modal.close()
            // document.getElementsByTagName('dialog')[0]?
            document.getElementsByTagName('dialog')[0].style="display:none";
        }
        const openModal = ()=>{
            // modal.open()
            document.getElementsByTagName('dialog')[0].style="display:flex";
        }
        
        
        var acc = document.getElementsByClassName('question-button');
        var i;
        for (i=0;i<acc.length;i++){
            acc[i].addEventListener("click", function(){
                this.classList.toggle('active');
                var panel = this.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                    panel.style.margin = null;
                    
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            })
        }
        const transId = localStorage.getItem("transId");

        const redeemButton = document.getElementById("redeem-button");
        const form = document.getElementById("form")
        // form.addEventListener("submit")
        // openModal(); 
        form.addEventListener("submit", function(){
            document.getElementById("text").style = "display:none;";
            document.getElementById("loader").style = "display:block;";
            const code = document.getElementById("code").value;
            const email = document.getElementById("email").value;
            const payLoad = {code:code, email:email}
            console.log(payLoad);
            fetch(`${prodApi}/redeem-pay?code=${code}&email=${email}`).then((res)=>{
                console.log(res);
                document.getElementById("text").style = "display:inline;";
                document.getElementById("loader").style = "display:none;";
                res.json().then((response)=>{ 
                    console.log(response)
                    if(response.status==="SUCCESSFUL"){
                        openModal();
                        // alert("EMAIL SENT");

                    }
                    else{
                        alert("CODE IS WRONG")
                    }
                })
            })

        })
    </script>
</body>
</html>


